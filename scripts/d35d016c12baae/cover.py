import argparse
import pathlib

from PIL import Image, ImageDraw, ImageFont

DATA = [
    [
        ("              ", "#0f0f23"),
        ("..........", "#ccccff"),
        ("|", "#ff0000"),
        ("..........", "#ccccff"),
        ("                ", "#0f0f23"),
        (" 1", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("   ", "#0f0f23"),
        (".....''''''", "#ccccff"),
        (" ", "#0f0f23"),
        (".'", "#ffffff"),
        ("  ", "#0f0f23"),
        ("-", "#ffffff"),
        ("  ", "#0f0f23"),
        ("-", "#ffffff"),
        ("  ", "#0f0f23"),
        ("\\", "#cccccc"),
        ("-", "#ffffff"),
        (" ", "#0f0f23"),
        (".''", "#ffffff"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("''''''.....", "#ccccff"),
        ("     ", "#0f0f23"),
        (" 2", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("'''", "#ccccff"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("'.'.", "#ffffff"),
        (" ", "#0f0f23"),
        ("-", "#ffffff"),
        ("   ", "#0f0f23"),
        ("-", "#ffffff"),
        (" ", "#0f0f23"),
        ("\\", "#cccccc"),
        (" ", "#0f0f23"),
        ("-'':", "#ffffff"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("'''", "#ccccff"),
        ("  ", "#0f0f23"),
        (" 3", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("''..'''", "#ffffff"),
        ("_[]", "#cccccc"),
        (".'", "#ffffff"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        (" 4", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        (".'.", "#00cc00"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("____/", "#cccccc"),
        (" ", "#0f0f23"),
        ("''", "#ffffff"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        (" 5", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("''", "#00cc00"),
        ("  ", "#0f0f23"),
        ("..", "#00cc00"),
        ("_____/", "#cccccc"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("_", "#9900ff"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("_", "#9900ff"),
        ("   ", "#0f0f23"),
        ("O>", "#9900ff"),
        ("    ", "#0f0f23"),
        (" 6", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        (":", "#00cc00"),
        ("[]", "#cccccc"),
        ("'.", "#00cc00"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("\\", "#9900ff"),
        (" ", "#0f0f23"),
        ("/", "#9900ff"),
        (" ", "#0f0f23"),
        ("\\", "#9900ff"),
        (" ", "#0f0f23"),
        ("/", "#9900ff"),
        (" ", "#0f0f23"),
        ("\\", "#9900ff"),
        (" ", "#0f0f23"),
        ("/", "#9900ff"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        (" 7", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("       ", "#0f0f23"),
        ("~", "#333399"),
        ("     ", "#0f0f23"),
        ("'.", "#00cc00"),
        ("\\", "#cccccc"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("        ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        (" 8", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("\\", "#cccccc"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("____", "#cccccc"),
        ("     ", "#0f0f23"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("17", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("       ", "#0f0f23"),
        ("~", "#333399"),
        ("       ", "#0f0f23"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("\\____/", "#cccccc"),
        (" ", "#0f0f23"),
        (".''", "#00cc00"),
        ("\\", "#cccccc"),
        ("'..", "#00cc00"),
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        ("       ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        (".", "#00cc00"),
        ("  ", "#0f0f23"),
        (" 9", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        ("       ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("__/\\", "#cccccc"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        (".'", "#00cc00"),
        ("^", "#ffffff"),
        (" ", "#0f0f23"),
        ("[]", "#cccccc"),
        (".'", "#00cc00"),
        ("      ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("..''", "#00cc00"),
        ("   ", "#0f0f23"),
        ("16", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("...", "#00cc00"),
        ("     ", "#0f0f23"),
        ("~", "#333399"),
        ("_____/", "#cccccc"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("\\", "#cccccc"),
        ("    ", "#0f0f23"),
        (":", "#00cc00"),
        ("^", "#ffffff"),
        (" ", "#0f0f23"),
        (",", "#00cc00"),
        (" ", "#0f0f23"),
        (":", "#00cc00"),
        ("\\", "#cccccc"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("       ", "#0f0f23"),
        (":''", "#00cc00"),
        ("  ", "#0f0f23"),
        (",", "#00cc00"),
        (" ", "#0f0f23"),
        ("^", "#ffffff"),
        ("  ", "#0f0f23"),
        ("18", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("###:", "#00cc00"),
        (" ", "#0f0f23"),
        ("...", "#00cc00"),
        ("/", "#cccccc"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("~", "#333399"),
        ("\\", "#cccccc"),
        ("    ", "#0f0f23"),
        ("'..'", "#00cc00"),
        ("  ", "#0f0f23"),
        ("\\_______", "#cccccc"),
        ("~", "#333399"),
        (" ", "#0f0f23"),
        ("'.", "#00cc00"),
        (" ", "#0f0f23"),
        (",", "#00cc00"),
        ("      ", "#0f0f23"),
        ("15", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        (".''", "#00cc00"),
        (" ", "#0f0f23"),
        (".'", "#00cc00"),
        ("[]", "#cccccc"),
        ("'.", "#00cc00"),
        ("           ", "#0f0f23"),
        ("\\", "#cccccc"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("       ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("\\", "#cccccc"),
        ("  ", "#0f0f23"),
        (":", "#00cc00"),
        ("  ", "#0f0f23"),
        (",", "#00cc00"),
        (" ", "#0f0f23"),
        ("^", "#ffffff"),
        ("   ", "#0f0f23"),
        ("19", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("'...'##", "#00cc00"),
        ("\\", "#cccccc"),
        ("##'.", "#00cc00"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("\\", "#cccccc"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("            ", "#0f0f23"),
        (".", "#00cc00"),
        ("\\", "#cccccc"),
        ("'", "#00cc00"),
        (" ", "#0f0f23"),
        (",", "#00cc00"),
        ("  ", "#0f0f23"),
        ("^", "#ffffff"),
        (" ", "#0f0f23"),
        ("^", "#ffffff"),
        ("  ", "#0f0f23"),
        ("10", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("#####", "#00cc00"),
        (" ", "#0f0f23"),
        (",#", "#00cc00"),
        ("\\", "#cccccc"),
        ("#.'", "#00cc00"),
        ("           ", "#0f0f23"),
        ("\\", "#cccccc"),
        ("   ", "#0f0f23"),
        (".", "#00cc00"),
        ("       ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("'.", "#00cc00"),
        ("[]", "#cccccc"),
        ("  ", "#0f0f23"),
        (",", "#00cc00"),
        (" ", "#0f0f23"),
        ("^", "#ffffff"),
        ("   ", "#0f0f23"),
        ("14", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("#,", "#00cc00"),
        ("      ", "#0f0f23"),
        (",", "#00cc00"),
        ("\\", "#cccccc"),
        ("'.", "#00cc00"),
        ("         ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("\\", "#cccccc"),
        ("'',:", "#00cc00"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("       ", "#0f0f23"),
        ("_/", "#cccccc"),
        ("'..", "#00cc00"),
        ("  ", "#0f0f23"),
        (",", "#00cc00"),
        (" ", "#0f0f23"),
        ("^", "#ffffff"),
        ("  ", "#0f0f23"),
        ("20", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("   ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        ("   ", "#0f0f23"),
        (",", "#00cc00"),
        ("\\", "#cccccc"),
        (",'.", "#00cc00"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("     ", "#0f0f23"),
        (":", "#00cc00"),
        ("[]", "#cccccc"),
        ("..'", "#00cc00"),
        ("         ", "#0f0f23"),
        ("/", "#cccccc"),
        (" ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("''...", "#00cc00"),
        ("  ", "#0f0f23"),
        ("11", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        ("    ", "#0f0f23"),
        ("\\", "#cccccc"),
        (",", "#00cc00"),
        (" ", "#0f0f23"),
        (":", "#00cc00"),
        ("         ", "#0f0f23"),
        ("''", "#00cc00"),
        ("\\__", "#cccccc"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("     ", "#0f0f23"),
        ("/", "#cccccc"),
        ("             ", "#0f0f23"),
        ("13", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        (",", "#00cc00"),
        ("[]", "#cccccc"),
        (":", "#00cc00"),
        ("     ", "#0f0f23"),
        ("~", "#333399"),
        ("     ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("\\__", "#cccccc"),
        ("    ", "#0f0f23"),
        ("/", "#cccccc"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("21", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        ("  ", "#0f0f23"),
        (",", "#00cc00"),
        (" ", "#0f0f23"),
        (".", "#00cc00"),
        ("\\______", "#cccccc"),
        ("           ", "#0f0f23"),
        ("\\__/", "#cccccc"),
        ("               ", "#0f0f23"),
        ("12", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        (" ", "#0f0f23"),
        ("~", "#ffcc99"),
        ("    ", "#0f0f23"),
        ("..'", "#00cc00"),
        ("   ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("\\______", "#cccccc"),
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        ("         ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("~", "#333399"),
        ("   ", "#0f0f23"),
        ("22", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("  ", "#0f0f23"),
        (".....'''", "#00cc00"),
        ("           ", "#0f0f23"),
        ("~", "#333399"),
        ("     ", "#0f0f23"),
        ("~", "#333399"),
        ("\\____", "#cccccc"),
        ("                  ", "#0f0f23"),
        ("23", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("''", "#00cc00"),
        ("         ", "#0f0f23"),
        ("~", "#333399"),
        ("                 ", "#0f0f23"),
        (".'..", "#00cc00"),
        ("\\___", "#cccccc"),
        ("''..", "#00cc00"),
        ("       ", "#0f0f23"),
        ("~", "#333399"),
        ("  ", "#0f0f23"),
        ("24", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
    [
        ("     ", "#0f0f23"),
        ("~", "#333399"),
        ("          ", "#0f0f23"),
        ("~", "#333399"),
        ("        ", "#0f0f23"),
        ("~", "#333399"),
        ("    ", "#0f0f23"),
        ("'.'", "#00cc00"),
        ("  ", "#0f0f23"),
        (":", "#00cc00"),
        (" ", "#0f0f23"),
        ("[]", "#cccccc"),
        (" ", "#0f0f23"),
        (".'", "#00cc00"),
        ("  ", "#0f0f23"),
        ("~", "#333399"),
        ("      ", "#0f0f23"),
        ("25", "#cccccc"),
        (" ", "#0f0f23"),
        ("*", "#ffff66"),
        ("*", "#ffff66"),
    ],
]


def generate(font_path: pathlib.Path) -> Image:
    # generate ascii art image
    font = ImageFont.truetype(str(font_path), size=30)
    row_w, row_h = 0, 0
    for row in DATA:
        line = "".join([s for s, _ in row])
        w, h = font.getsize(line)
        row_w = max(row_w, w)
        row_h = max(row_h, h)

    padding = 8
    image = Image.new(
        "RGB", (row_w + padding * 2, row_h * 25 + 24 + padding * 2), "#0f0f23"
    )
    draw = ImageDraw.Draw(image)
    for i, row in enumerate(DATA):
        offset = 0
        for s, color in row:
            draw.text(
                (padding + offset, padding + i * (row_h + 1)), s, font=font, fill=color,
            )
            offset += draw.textsize(s, font=font)[0]

    w, h = image.size
    scale = w / 500.0
    resized = image.resize((round(w / scale), round(h / scale)), resample=Image.LANCZOS)

    # generate title part
    title = Image.new("RGB", (500, 700 - resized.height), "#0f0f23")
    title_font = ImageFont.truetype(str(font_path), size=50)
    title_draw = ImageDraw.Draw(title)
    sizes = [title_font.getsize("Advent of Code"), title_font.getsize("2020")]
    title_draw.text(
        ((500 - sizes[0][0]) / 2, (title.height / 2 - sizes[0][1]) / 2),
        "Advent of Code",
        font=title_font,
        fill="#00cc00",
    )
    title_draw.text(
        ((500 - sizes[1][0]) / 2, (title.height * 1.2 - sizes[1][1]) / 2),
        "2020",
        font=title_font,
        fill="#00cc00",
    )

    # generate cover image
    cover = Image.new("RGB", (500, 700), "#0f0f23")
    cover.paste(title, (0, 0))
    cover.paste(resized, (0, title.height))

    return cover


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--font", type=pathlib.Path, required=True)
    parser.add_argument("--out", type=pathlib.Path, default=pathlib.Path("cover.png"))
    args = parser.parse_args()

    image = generate(args.font)
    image.save(args.out)
